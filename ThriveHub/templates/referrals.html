{% extends 'layout.html' %}

{% block title %}
    Call Reports
{% endblock %}

{% block content %}

        {% block referral_table %}
        <!-- Welcome Message -->
        <div class="container mt-4">
            <div class="row align-items-center">
                <div class="col-4">
                    <h2 class="section-title"> Referral Contacts
                        <a href="{% url 'add_referral' %}" class="btn btn-sm def-btn">
                            <i class="fa-solid fa-plus"></i>
                        </a>
                    </h2>
                </div>

                <div class="col-8">
                <form method="GET" class="d-flex justify-content-end">
                    <input type="text" name="search" placeholder="Search by name" value="{{ request.GET.search }}">
                    <select name="gender" class="form-select" aria-label="Gender">
                        <option value="All" {% if request.GET.gender == "All" %}selected{% endif %}> All Gender </option>
                        <option value="Male" {% if request.GET.gender == "Male" %}selected{% endif %}> Male </option>
                        <option value="Female" {% if request.GET.gender == "Female" %}selected{% endif %}> Female </option>
                    </select>
                    <input type="text" name="location" placeholder="Filter by location" value="{{ request.GET.location }}">
                    <button class="btn def-btn" type="submit">Filter</button>
                </form>
                </div>

            </div>

        <div class="table-container">
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Gender</th>
                        <th>Location</th>
                        <th>Phone Number</th>
                        <th>Email Address</th>
                        <th>Last Updated</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for contact in contacts %}
                    <tr class="contact-row" data-href="{% url 'edit_referral' contact.pk %}">
                        <td>{{ contact.name }}</td>
                        <td>{{ contact.gender }}</td>
                        <td>{{ contact.location }}</td>
                        <td>{{ contact.phone }}</td>
                        <td>{{ contact.email }}</td>
                        <td>{{ contact.date_updated }}</td>
                        <td class="delete-icon-cell">
                            <a href="{% url 'delete_referral' contact.pk %}" class="delete-icon"><i class="fa fa-trash"></i></a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <script>
            // Make the entire row clickable to edit
            document.querySelectorAll('.contact-row').forEach(row => {
                row.addEventListener('click', function() {
                    window.location = row.getAttribute('data-href');
                });
            });
        </script>
        {% endblock %}

        </div>
    </div>
</div>


</body>
</html>

{% endblock %}
